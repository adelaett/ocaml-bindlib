cst Z Atom;
cst S 1 Prefix 10.0;
cst + 2 Infix 1.0;
cst * 2 Infix 2.0;
cst ! 1 Infix 3.0;

let n1 = S Z;
let n2 = S n1;
let n3 = S n2;
let n4 = S n3;
let n5 = S n4;
let n6 = S n5;
let n7 = S n6;
let n8 = S n7;
let n9 = S n8;
let n10 = S n9;


red S X[] + Y[] -> S (X[] + Y[]);
red Z + X[] -> X[];

red S X[] * Y[] -> Y[] + X[] * Y[];
red Z * Y[] -> Z;

red Z! -> n1;
red (S X[])! -> S X[] * X[]!;

n7!;